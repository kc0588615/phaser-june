"use strict";(globalThis.webpackChunkwiki=globalThis.webpackChunkwiki||[]).push([[93838],{6833(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"guides/game/clue-board","title":"Clue Board Implementation","description":"How the match-3 puzzle generates and displays clues","source":"@site/docs/guides/game/clue-board.md","sourceDirName":"guides/game","slug":"/guides/game/clue-board","permalink":"/phaser-june/docs/guides/game/clue-board","draft":false,"unlisted":false,"editUrl":"https://github.com/kc0588615/phaser-june/tree/main/wiki/docs/guides/game/clue-board.md","tags":[{"inline":true,"label":"guide","permalink":"/phaser-june/docs/tags/guide"},{"inline":true,"label":"phaser","permalink":"/phaser-june/docs/tags/phaser"},{"inline":true,"label":"clues","permalink":"/phaser-june/docs/tags/clues"},{"inline":true,"label":"game-logic","permalink":"/phaser-june/docs/tags/game-logic"}],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Clue Board Implementation","description":"How the match-3 puzzle generates and displays clues","tags":["guide","phaser","clues","game-logic"],"difficulty":"Intermediate"},"sidebar":"docsSidebar","previous":{"title":"How-To Guides","permalink":"/phaser-june/docs/category/guides"},"next":{"title":"Species Discovery Flow","permalink":"/phaser-june/docs/guides/game/species-discovery"}}');var t=s(74848),r=s(28453);const l={sidebar_position:1,title:"Clue Board Implementation",description:"How the match-3 puzzle generates and displays clues",tags:["guide","phaser","clues","game-logic"],difficulty:"Intermediate"},c="Clue Board Implementation Guide",d={},a=[{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Component Structure",id:"component-structure",level:2},{value:"Core Components",id:"core-components",level:3},{value:"Event Flow",id:"event-flow",level:3},{value:"Clue Payload Structure",id:"clue-payload-structure",level:2},{value:"Color-Category Mapping",id:"color-category-mapping",level:2},{value:"Progressive Classification System",id:"progressive-classification-system",level:2},{value:"Revelation Sequence",id:"revelation-sequence",level:3},{value:"Implementation",id:"implementation",level:3},{value:"UI Handling for Progressive Clues",id:"ui-handling-for-progressive-clues",level:3},{value:"Adding a New Clue Category",id:"adding-a-new-clue-category",level:2},{value:"Step 1: Define the Category",id:"step-1-define-the-category",level:3},{value:"Step 2: Add Gem Type",id:"step-2-add-gem-type",level:3},{value:"Step 3: Map Gem to Category",id:"step-3-map-gem-to-category",level:3},{value:"Step 4: Add Asset Files",id:"step-4-add-asset-files",level:3},{value:"State Management",id:"state-management",level:2},{value:"SpeciesPanel State",id:"speciespanel-state",level:3},{value:"Event Listeners",id:"event-listeners",level:3},{value:"User Experience Flow",id:"user-experience-flow",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"clue-board-implementation-guide",children:"Clue Board Implementation Guide"})}),"\n",(0,t.jsx)(n.p,{children:"This guide explains how the match-3 puzzle board generates clues and communicates them to the React UI."}),"\n",(0,t.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,t.jsx)(n.p,{children:"The clue system follows a clean separation of concerns:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Layer"}),(0,t.jsx)(n.th,{children:"Responsibility"}),(0,t.jsx)(n.th,{children:"Technology"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Game Logic"}),(0,t.jsx)(n.td,{children:"Gem matching, clue generation"}),(0,t.jsx)(n.td,{children:"Phaser"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"EventBus"}),(0,t.jsx)(n.td,{children:"Cross-framework communication"}),(0,t.jsx)(n.td,{children:"Custom EventEmitter"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"UI Components"}),(0,t.jsx)(n.td,{children:"Clue display, notifications"}),(0,t.jsx)(n.td,{children:"React"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Notifications"}),(0,t.jsx)(n.td,{children:"Real-time feedback"}),(0,t.jsx)(n.td,{children:"Sonner toasts"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"component-structure",children:"Component Structure"}),"\n",(0,t.jsx)(n.h3,{id:"core-components",children:"Core Components"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"SpeciesPanel.tsx          # Main container, event orchestration\n\u251c\u2500\u2500 SpeciesHeaderCard.tsx # Species info, colored dot indicators\n\u251c\u2500\u2500 DenseClueGrid.tsx     # Compact clue list\n\u2514\u2500\u2500 ClueSheet.tsx         # Detailed slide-out panel\n"})}),"\n",(0,t.jsx)(n.h3,{id:"event-flow",children:"Event Flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Player\n    participant Phaser as Game.ts\n    participant Config as clueConfig.ts\n    participant EventBus\n    participant Panel as SpeciesPanel\n    participant Toast as Sonner\n\n    Player->>Phaser: Match 3+ gems\n    Phaser->>Config: getClue(species, category)\n    Config--\x3e>Phaser: clue text\n    Phaser->>EventBus: emit('clue-revealed', payload)\n    EventBus->>Panel: handleClueRevealed\n    Panel->>Panel: Update state\n    Panel->>Toast: Show notification"}),"\n",(0,t.jsx)(n.h2,{id:"clue-payload-structure",children:"Clue Payload Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface CluePayload {\n  category: GemCategory;    // Enum (0-7)\n  heading: string;          // Category display name\n  clue: string;             // The actual clue text\n  speciesId: number;        // Current species ID\n  name: string;             // Category name\n  icon: string;             // Emoji icon\n  color: string;            // Gem color for UI\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"color-category-mapping",children:"Color-Category Mapping"}),"\n",(0,t.jsx)(n.p,{children:"Each gem color corresponds to a clue category:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Color"}),(0,t.jsx)(n.th,{children:"Category"}),(0,t.jsx)(n.th,{children:"Icon"}),(0,t.jsx)(n.th,{children:"Database Fields"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Red"}),(0,t.jsx)(n.td,{children:"Classification"}),(0,t.jsx)(n.td,{children:"\ud83e\uddec"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"phylum"}),", ",(0,t.jsx)(n.code,{children:"class"}),", ",(0,t.jsx)(n.code,{children:"order_"}),", ",(0,t.jsx)(n.code,{children:"family"}),", ",(0,t.jsx)(n.code,{children:"genus"}),", ",(0,t.jsx)(n.code,{children:"sci_name"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Green"}),(0,t.jsx)(n.td,{children:"Habitat (Raster)"}),(0,t.jsx)(n.td,{children:"\ud83c\udf33"}),(0,t.jsx)(n.td,{children:"Cesium raster data"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Blue"}),(0,t.jsx)(n.td,{children:"Geographic"}),(0,t.jsx)(n.td,{children:"\ud83d\uddfa\ufe0f"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"geo_desc"}),", ",(0,t.jsx)(n.code,{children:"dist_comm"}),", ",(0,t.jsx)(n.code,{children:"hab_desc"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Orange"}),(0,t.jsx)(n.td,{children:"Morphology"}),(0,t.jsx)(n.td,{children:"\ud83d\udc06"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"pattern"}),", ",(0,t.jsx)(n.code,{children:"color_prim"}),", ",(0,t.jsx)(n.code,{children:"size_max"}),", ",(0,t.jsx)(n.code,{children:"weight_kg"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Yellow"}),(0,t.jsx)(n.td,{children:"Behavior & Diet"}),(0,t.jsx)(n.td,{children:"\ud83d\udca8"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"behav_1"}),", ",(0,t.jsx)(n.code,{children:"diet_type"}),", ",(0,t.jsx)(n.code,{children:"diet_prey"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Black"}),(0,t.jsx)(n.td,{children:"Life Cycle"}),(0,t.jsx)(n.td,{children:"\u23f3"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"life_desc1"}),", ",(0,t.jsx)(n.code,{children:"lifespan"}),", ",(0,t.jsx)(n.code,{children:"clutch_sz"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"White"}),(0,t.jsx)(n.td,{children:"Conservation"}),(0,t.jsx)(n.td,{children:"\ud83d\udee1\ufe0f"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"cons_text"}),", ",(0,t.jsx)(n.code,{children:"threats"}),", ",(0,t.jsx)(n.code,{children:"cons_code"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Purple"}),(0,t.jsx)(n.td,{children:"Key Facts"}),(0,t.jsx)(n.td,{children:"\ud83d\udd2e"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"key_fact1"}),", ",(0,t.jsx)(n.code,{children:"key_fact2"}),", ",(0,t.jsx)(n.code,{children:"key_fact3"})]})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"progressive-classification-system",children:"Progressive Classification System"}),"\n",(0,t.jsx)(n.p,{children:"The Classification category (red gems) reveals clues progressively:"}),"\n",(0,t.jsx)(n.h3,{id:"revelation-sequence",children:"Revelation Sequence"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"1st Red Match:"})," ",(0,t.jsx)(n.code,{children:"Phylum: CHORDATA"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"2nd Red Match:"})," ",(0,t.jsx)(n.code,{children:"Class: REPTILIA"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"3rd Red Match:"})," ",(0,t.jsx)(n.code,{children:"Order: TESTUDINES"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"4th Red Match:"})," ",(0,t.jsx)(n.code,{children:"Family: EMYDIDAE"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"5th Red Match:"})," ",(0,t.jsx)(n.code,{children:"Genus: Emydoidea"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"6th Red Match:"})," ",(0,t.jsx)(n.code,{children:"Scientific name: Emydoidea blandingii"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// src/game/clueConfig.ts\nconst CLASSIFICATION_SEQUENCE: Array<keyof Species> = [\n  'phylum', 'class', 'order_', 'family', 'genus', 'sci_name'\n];\n\n// WeakMap for memory-efficient progress tracking\nconst classificationProgress = new WeakMap<Species, number>();\n\nfunction getNextClassificationClue(species: Species): string {\n  let progress = classificationProgress.get(species) ?? 0;\n\n  while (progress < CLASSIFICATION_SEQUENCE.length) {\n    const field = CLASSIFICATION_SEQUENCE[progress];\n    const value = species[field];\n    progress++;\n    classificationProgress.set(species, progress);\n\n    if (value) {\n      return `${formatFieldName(field)}: ${value}`;\n    }\n    // Skip missing fields but count progress\n  }\n\n  return ''; // Sequence complete\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ui-handling-for-progressive-clues",children:"UI Handling for Progressive Clues"}),"\n",(0,t.jsx)(n.p,{children:"The SpeciesPanel allows multiple clues from Classification:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Before: Blocked all duplicate categories\nif (prev.some(c => c.category === clueData.category)) return prev;\n\n// After: Special handling for Classification\nconst isDuplicate = clueData.category === 0 ?\n  prev.some(c => c.clue === clueData.clue) :  // Check text, not category\n  prev.some(c => c.category === clueData.category);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"adding-a-new-clue-category",children:"Adding a New Clue Category"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-define-the-category",children:"Step 1: Define the Category"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// src/game/clueConfig.ts\nexport enum GemCategory {\n  CLASSIFICATION = 0,\n  HABITAT = 1,\n  // ... existing categories\n  NEW_CATEGORY = 8,  // Add new enum value\n}\n\nexport const CLUE_CONFIG = {\n  categories: {\n    [GemCategory.NEW_CATEGORY]: {\n      displayName: 'New Category',\n      icon: '\u2728',\n      color: 'cyan',\n      fields: ['new_field1', 'new_field2'],\n    },\n  },\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-2-add-gem-type",children:"Step 2: Add Gem Type"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// src/game/constants.ts\nexport const GEM_TYPES = [\n  'black', 'blue', 'green', 'orange',\n  'red', 'white', 'yellow', 'purple',\n  'cyan',  // Add new color\n];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-3-map-gem-to-category",children:"Step 3: Map Gem to Category"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// src/game/scenes/Game.ts\nprivate gemTypeToCategory: Record<string, GemCategory> = {\n  'red': GemCategory.CLASSIFICATION,\n  // ... existing mappings\n  'cyan': GemCategory.NEW_CATEGORY,\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-4-add-asset-files",children:"Step 4: Add Asset Files"}),"\n",(0,t.jsxs)(n.p,{children:["Place in ",(0,t.jsx)(n.code,{children:"public/assets/"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"cyan_gem_0.png"})," through ",(0,t.jsx)(n.code,{children:"cyan_gem_7.png"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"state-management",children:"State Management"}),"\n",(0,t.jsx)(n.h3,{id:"speciespanel-state",children:"SpeciesPanel State"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const [clues, setClues] = useState<CluePayload[]>([]);\nconst [selectedSpeciesName, setSelectedSpeciesName] = useState('');\nconst [discoveredClues, setDiscoveredClues] = useState<Array<{\n  name: string;\n  color: string;\n  icon: string;\n}>>([]);\nconst [allCluesRevealed, setAllCluesRevealed] = useState(false);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"event-listeners",children:"Event Listeners"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"useEffect(() => {\n  const handlers = {\n    'clue-revealed': handleClueRevealed,\n    'new-game-started': handleNewGame,\n    'game-reset': handleReset,\n    'all-clues-revealed': handleAllCluesRevealed,\n    'all-species-completed': handleAllComplete,\n  };\n\n  Object.entries(handlers).forEach(([event, handler]) => {\n    EventBus.on(event, handler);\n  });\n\n  return () => {\n    Object.entries(handlers).forEach(([event, handler]) => {\n      EventBus.off(event, handler);\n    });\n  };\n}, []);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user-experience-flow",children:"User Experience Flow"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Initial State:"})," Empty grid with instructions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Species Selection:"})," Player clicks map location"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Gem Matching:"})," Match reveals clue + toast notification"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Progress Tracking:"})," Colored dots show discovered categories"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Completion:"})," Auto-advance to next species"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Package"}),(0,t.jsx)(n.th,{children:"Version"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"sonner"}),(0,t.jsx)(n.td,{children:"^1.5.0"}),(0,t.jsx)(n.td,{children:"Toast notifications"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"@radix-ui/react-dialog"}),(0,t.jsx)(n.td,{children:"-"}),(0,t.jsx)(n.td,{children:"Dialog components"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"@radix-ui/react-scroll-area"}),(0,t.jsx)(n.td,{children:"^1.0.0"}),(0,t.jsx)(n.td,{children:"Scroll areas"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"lucide-react"}),(0,t.jsx)(n.td,{children:"-"}),(0,t.jsx)(n.td,{children:"Icons"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/architecture/eventbus-display",children:"EventBus Architecture"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/guides/game/species-discovery",children:"Species Discovery"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/reference/database-schema",children:"Database Schema"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453(e,n,s){s.d(n,{R:()=>l,x:()=>c});var i=s(96540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);