"use strict";(globalThis.webpackChunkwiki=globalThis.webpackChunkwiki||[]).push([[51030],{22296(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"architecture/page-routing","title":"Page Routing Infrastructure","description":"Next.js routing with server runtime configuration","source":"@site/docs/architecture/page-routing.md","sourceDirName":"architecture","slug":"/architecture/page-routing","permalink":"/phaser-june/docs/architecture/page-routing","draft":false,"unlisted":false,"editUrl":"https://github.com/kc0588615/phaser-june/tree/main/wiki/docs/architecture/page-routing.md","tags":[{"inline":true,"label":"architecture","permalink":"/phaser-june/docs/tags/architecture"},{"inline":true,"label":"nextjs","permalink":"/phaser-june/docs/tags/nextjs"},{"inline":true,"label":"routing","permalink":"/phaser-june/docs/tags/routing"}],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Page Routing Infrastructure","description":"Next.js routing with server runtime configuration","tags":["architecture","nextjs","routing"]},"sidebar":"docsSidebar","previous":{"title":"UI Display System Reference","permalink":"/phaser-june/docs/architecture/ui-display-system"},"next":{"title":"How-To Guides","permalink":"/phaser-june/docs/category/guides"}}');var t=i(74848),r=i(28453);const l={sidebar_position:4,title:"Page Routing Infrastructure",description:"Next.js routing with server runtime configuration",tags:["architecture","nextjs","routing"]},c="Page Routing Infrastructure",d={},o=[{value:"Page Types",id:"page-types",level:2},{value:"1. Complex Game Pages",id:"1-complex-game-pages",level:3},{value:"2. Simple Content Pages",id:"2-simple-content-pages",level:3},{value:"Key Components",id:"key-components",level:2},{value:"SimpleLayout Component",id:"simplelayout-component",level:3},{value:"Application Structure",id:"application-structure",level:3},{value:"Server Runtime Configuration",id:"server-runtime-configuration",level:2},{value:"next.config.mjs",id:"nextconfigmjs",level:3},{value:"Adding New Pages",id:"adding-new-pages",level:2},{value:"Step 1: Create the Page Component",id:"step-1-create-the-page-component",level:3},{value:"Step 2: Use Tailwind CSS",id:"step-2-use-tailwind-css",level:3},{value:"Step 3: Add Navigation",id:"step-3-add-navigation",level:3},{value:"Build Output",id:"build-output",level:2},{value:"Server Runtime Notes",id:"server-runtime-notes",level:2},{value:"Common Issues",id:"common-issues",level:2},{value:"404 Errors on Routes",id:"404-errors-on-routes",level:3},{value:"Styling Inconsistencies",id:"styling-inconsistencies",level:3},{value:"Best Practices",id:"best-practices",level:2}];function a(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"page-routing-infrastructure",children:"Page Routing Infrastructure"})}),"\n",(0,t.jsx)(n.p,{children:"This document describes the page routing infrastructure using Next.js server runtime (API routes + Drizzle)."}),"\n",(0,t.jsx)(n.h2,{id:"page-types",children:"Page Types"}),"\n",(0,t.jsx)(n.h3,{id:"1-complex-game-pages",children:"1. Complex Game Pages"}),"\n",(0,t.jsxs)(n.p,{children:["Example: ",(0,t.jsx)(n.code,{children:"index.tsx"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Uses ",(0,t.jsx)(n.code,{children:"MainAppLayout.tsx"})," for game-specific functionality"]}),"\n",(0,t.jsx)(n.li,{children:"Manages Phaser game canvas and Cesium 3D map"}),"\n",(0,t.jsx)(n.li,{children:"Requires complex state management and EventBus communication"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-simple-content-pages",children:"2. Simple Content Pages"}),"\n",(0,t.jsxs)(n.p,{children:["Example: ",(0,t.jsx)(n.code,{children:"highscores.tsx"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Uses ",(0,t.jsx)(n.code,{children:"SimpleLayout.tsx"})," for consistent styling"]}),"\n",(0,t.jsx)(n.li,{children:"Standard React pages with data fetching"}),"\n",(0,t.jsx)(n.li,{children:"No game engine dependencies"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,t.jsx)(n.h3,{id:"simplelayout-component",children:"SimpleLayout Component"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Location:"})," ",(0,t.jsx)(n.code,{children:"src/components/SimpleLayout.tsx"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface SimpleLayoutProps {\n  title: string;\n  description?: string;\n  children: React.ReactNode;\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Provides:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Consistent page structure for non-game pages"}),"\n",(0,t.jsx)(n.li,{children:"Head metadata handling"}),"\n",(0,t.jsx)(n.li,{children:"Dark theme styling via Tailwind CSS"}),"\n",(0,t.jsx)(n.li,{children:"Responsive container wrapper"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"application-structure",children:"Application Structure"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"File"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"src/pages/_app.tsx"})}),(0,t.jsx)(n.td,{children:"Global app wrapper"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"src/pages/_document.tsx"})}),(0,t.jsx)(n.td,{children:"HTML document structure with dark theme"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"src/styles/globals.css"})}),(0,t.jsx)(n.td,{children:"Global styles and Tailwind configuration"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"server-runtime-configuration",children:"Server Runtime Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"nextconfigmjs",children:"next.config.mjs"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"{\n  trailingSlash: true,\n  images: { unoptimized: true },\n  webpack: (config, { webpack, isServer }) => {\n    // Cesium + client fallbacks\n  }\n}\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"trailingSlash",type:"important",children:(0,t.jsxs)(n.p,{children:["Setting ",(0,t.jsx)(n.code,{children:"trailingSlash: true"})," keeps URL behavior consistent across pages."]})}),"\n",(0,t.jsx)(n.h2,{id:"adding-new-pages",children:"Adding New Pages"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-create-the-page-component",children:"Step 1: Create the Page Component"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// src/pages/newpage.tsx\nimport SimpleLayout from \'@/components/SimpleLayout\';\n\nexport default function NewPage() {\n  return (\n    <SimpleLayout title="Page Title" description="Page description">\n      {/* Your content here */}\n    </SimpleLayout>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"step-2-use-tailwind-css",children:"Step 2: Use Tailwind CSS"}),"\n",(0,t.jsx)(n.p,{children:"Follow the dark theme color scheme:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Class"}),(0,t.jsx)(n.th,{children:"Usage"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"bg-card"})}),(0,t.jsx)(n.td,{children:"Card backgrounds"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"text-foreground"})}),(0,t.jsx)(n.td,{children:"Primary text"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"text-muted-foreground"})}),(0,t.jsx)(n.td,{children:"Secondary text"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"border-border"})}),(0,t.jsx)(n.td,{children:"Borders"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"text-primary"})}),(0,t.jsx)(n.td,{children:"Accent color"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"step-3-add-navigation",children:"Step 3: Add Navigation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import Link from 'next/link';\nimport { Button } from '@/components/ui/button';\n\n<Link href=\"/newpage\">\n  <Button variant=\"outline\">Go to New Page</Button>\n</Link>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"build-output",children:"Build Output"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:".next/\n\u251c\u2500\u2500 server/              # Server runtime output\n\u2514\u2500\u2500 static/              # Static assets\n"})}),"\n",(0,t.jsx)(n.h2,{id:"server-runtime-notes",children:"Server Runtime Notes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["API routes are available under ",(0,t.jsx)(n.code,{children:"src/app/api/*"})]}),"\n",(0,t.jsx)(n.li,{children:"Server-side rendering is supported if needed"}),"\n",(0,t.jsxs)(n.li,{children:["Headers/redirects are handled in ",(0,t.jsx)(n.code,{children:"next.config.mjs"})," or Vercel settings"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,t.jsx)(n.h3,{id:"404-errors-on-routes",children:"404 Errors on Routes"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cause:"})," Page structure issues"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Use proper Next.js page structure"}),"\n",(0,t.jsx)(n.li,{children:"No standalone HTML/head tags"}),"\n",(0,t.jsxs)(n.li,{children:["Page must integrate with ",(0,t.jsx)(n.code,{children:"_app.tsx"})]}),"\n",(0,t.jsxs)(n.li,{children:["Ensure ",(0,t.jsx)(n.code,{children:"trailingSlash: true"})," in config"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"styling-inconsistencies",children:"Styling Inconsistencies"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cause:"})," Not using theme system"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"SimpleLayout"})," component"]}),"\n",(0,t.jsx)(n.li,{children:"Apply Tailwind classes instead of inline styles"}),"\n",(0,t.jsxs)(n.li,{children:["Reference theme variables from ",(0,t.jsx)(n.code,{children:"globals.css"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Consistency:"})," Always use ",(0,t.jsx)(n.code,{children:"SimpleLayout"})," for non-game pages"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type Safety:"})," Define TypeScript interfaces for props"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Accessibility:"})," Include proper page titles and descriptions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance:"})," Lazy load heavy components"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Error Handling:"})," Implement error boundaries for data fetching"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453(e,n,i){i.d(n,{R:()=>l,x:()=>c});var s=i(96540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);